
import type { CropDetails, CropId, GameState, Plot, MarketItem, SeedId, TierInfo } from '@/types';

export const GRID_ROWS = 3;
export const GRID_COLS = 5;
export const TOTAL_PLOTS = GRID_ROWS * GRID_COLS;

export const INITIAL_GOLD = 100;
export const INITIAL_XP = 0;
export const INITIAL_LEVEL = 1;

export const TIER_NAMES: string[] = [
  "N√¥ng D√¢n T·∫≠p S·ª±",    // Tier 1 (Level 1-9)
  "Ch·ªß V∆∞·ªùn ChƒÉm Ch·ªâ",  // Tier 2 (Level 10-19)
  "Nh√† Tr·ªìng Tr·ªçt Kh√©o L√©o",// Tier 3 (Level 20-29)
  "Chuy√™n Gia M√πa V·ª•", // Tier 4 (Level 30-39)
  "B·∫≠c Th·∫ßy N√¥ng S·∫£n",  // Tier 5 (Level 40-49)
  "L√£o N√¥ng Uy√™n B√°c",  // Tier 6 (Level 50-59)
  "Ph√∫ N√¥ng Gi√†u C√≥",    // Tier 7 (Level 60-69)
  "Ho√†ng Gia N√¥ng Nghi·ªáp",// Tier 8 (Level 70-79)
  "Th·∫ßn N√¥ng T√°i Th·∫ø",  // Tier 9 (Level 80-89)
  "Huy·ªÅn Tho·∫°i ƒê·∫•t ƒêai" // Tier 10 (Level 90+)
];

export const getPlayerTierInfo = (level: number): TierInfo => {
  const tier = Math.min(Math.floor((level - 1) / 10) + 1, TIER_NAMES.length);
  const tierName = TIER_NAMES[tier - 1] || TIER_NAMES[TIER_NAMES.length - 1];
  const nextTierLevel = tier < TIER_NAMES.length ? tier * 10 + 1 : undefined;
  return { tier, tierName, nextTierLevel };
};


export const CROP_DATA: Record<CropId, CropDetails> = {
  tomato: { name: 'C√† Chua', seedName: 'tomatoSeed', icon: 'üçÖ', timeToGrowing: 60000, timeToReady: 120000, harvestYield: 3, seedPrice: 5, cropPrice: 2, unlockTier: 1 },
  carrot: { name: 'C√† R·ªët', seedName: 'carrotSeed', icon: 'ü•ï', timeToGrowing: 120000, timeToReady: 240000, harvestYield: 2, seedPrice: 8, cropPrice: 5, unlockTier: 1 },
  corn: { name: 'Ng√¥', seedName: 'cornSeed', icon: 'üåΩ', timeToGrowing: 180000, timeToReady: 360000, harvestYield: 1, seedPrice: 12, cropPrice: 15, unlockTier: 1 },
  strawberry: { name: 'D√¢u T√¢y', seedName: 'strawberrySeed', icon: 'üçì', timeToGrowing: 90000, timeToReady: 200000, harvestYield: 4, seedPrice: 10, cropPrice: 3, unlockTier: 1 },
  potato: { name: 'Khoai T√¢y', seedName: 'potatoSeed', icon: 'ü•î', timeToGrowing: 115000, timeToReady: 240000, harvestYield: 4, seedPrice: 7, cropPrice: 2, unlockTier: 1 },
  lettuce: { name: 'X√† L√°ch', seedName: 'lettuceSeed', icon: 'ü•¨', timeToGrowing: 65000, timeToReady: 150000, harvestYield: 1, seedPrice: 4, cropPrice: 5, unlockTier: 1 },
  
  blueberry: { name: 'Vi·ªát Qu·∫•t', seedName: 'blueberrySeed', icon: 'ü´ê', timeToGrowing: 100000, timeToReady: 220000, harvestYield: 5, seedPrice: 12, cropPrice: 3, unlockTier: 2 },
  onion: { name: 'H√†nh T√¢y', seedName: 'onionSeed', icon: 'üßÖ', timeToGrowing: 95000, timeToReady: 200000, harvestYield: 3, seedPrice: 6, cropPrice: 2, unlockTier: 2 },
  cucumber: { name: 'D∆∞a Chu·ªôt', seedName: 'cucumberSeed', icon: 'ü•í', timeToGrowing: 75000, timeToReady: 180000, harvestYield: 2, seedPrice: 5, cropPrice: 3, unlockTier: 2 },
  spinach: { name: 'Rau Bina', seedName: 'spinachSeed', icon: 'ü•¨', timeToGrowing: 50000, timeToReady: 110000, harvestYield: 2, seedPrice: 3, cropPrice: 2, unlockTier: 2 },
  radish: { name: 'C·ªß C·∫£i', seedName: 'radishSeed', icon: '‚ö™', timeToGrowing: 70000, timeToReady: 160000, harvestYield: 3, seedPrice: 6, cropPrice: 3, unlockTier: 2 },
  peas: { name: 'ƒê·∫≠u H√† Lan', seedName: 'peasSeed', icon: 'üü¢', timeToGrowing: 60000, timeToReady: 130000, harvestYield: 10, seedPrice: 9, cropPrice: 1, unlockTier: 2 },
  
  lemon: { name: 'Chanh V√†ng', seedName: 'lemonSeed', icon: 'üçã', timeToGrowing: 100000, timeToReady: 230000, harvestYield: 4, seedPrice: 9, cropPrice: 3, unlockTier: 3 },
  eggplant: { name: 'C√† T√≠m', seedName: 'eggplantSeed', icon: 'üçÜ', timeToGrowing: 135000, timeToReady: 270000, harvestYield: 3, seedPrice: 11, cropPrice: 4, unlockTier: 3 },
  garlic: { name: 'T·ªèi', seedName: 'garlicSeed', icon: 'üßÑ', timeToGrowing: 85000, timeToReady: 190000, harvestYield: 5, seedPrice: 8, cropPrice: 2, unlockTier: 3 },
  zucchini: { name: 'B√≠ Ng√≤i', seedName: 'zucchiniSeed', icon: 'ü•í', timeToGrowing: 80000, timeToReady: 170000, harvestYield: 2, seedPrice: 7, cropPrice: 4, unlockTier: 3 },
  celery: { name: 'C·∫ßn T√¢y', seedName: 'celerySeed', icon: 'ü•¨', timeToGrowing: 70000, timeToReady: 150000, harvestYield: 1, seedPrice: 5, cropPrice: 6, unlockTier: 3 },
  turnip: { name: 'C·ªß C·∫£i Turnip', seedName: 'turnipSeed', icon: 'üü£', timeToGrowing: 75000, timeToReady: 160000, harvestYield: 2, seedPrice: 6, cropPrice: 4, unlockTier: 3 },
  
  mango: { name: 'Xo√†i', seedName: 'mangoSeed', icon: 'ü•≠', timeToGrowing: 180000, timeToReady: 400000, harvestYield: 2, seedPrice: 20, cropPrice: 12, unlockTier: 4 },
  broccoli: { name: 'B√¥ng C·∫£i Xanh', seedName: 'broccoliSeed', icon: 'ü•¶', timeToGrowing: 105000, timeToReady: 220000, harvestYield: 1, seedPrice: 10, cropPrice: 12, unlockTier: 4 },
  bellpepper: { name: '·ªöt Chu√¥ng', seedName: 'bellpepperSeed', icon: 'ü´ë', timeToGrowing: 125000, timeToReady: 260000, harvestYield: 3, seedPrice: 13, cropPrice: 5, unlockTier: 4 },
  cabbage: { name: 'B·∫Øp C·∫£i', seedName: 'cabbageSeed', icon: 'ü•¨', timeToGrowing: 110000, timeToReady: 230000, harvestYield: 1, seedPrice: 7, cropPrice: 8, unlockTier: 4 },
  cauliflower: { name: 'S√∫p L∆° Tr·∫Øng', seedName: 'cauliflowerSeed', icon: 'ü•¶', timeToGrowing: 115000, timeToReady: 240000, harvestYield: 1, seedPrice: 11, cropPrice: 13, unlockTier: 4 },
  beetroot: { name: 'C·ªß D·ªÅn', seedName: 'beetrootSeed', icon: 'üî¥', timeToGrowing: 90000, timeToReady: 200000, harvestYield: 2, seedPrice: 8, cropPrice: 5, unlockTier: 4 },
  
  kiwi: { name: 'Kiwi', seedName: 'kiwiSeed', icon: 'ü•ù', timeToGrowing: 130000, timeToReady: 280000, harvestYield: 3, seedPrice: 15, cropPrice: 6, unlockTier: 5 },
  apple: { name: 'T√°o ƒê·ªè', seedName: 'appleSeed', icon: 'üçé', timeToGrowing: 140000, timeToReady: 290000, harvestYield: 2, seedPrice: 14, cropPrice: 8, unlockTier: 5 },
  banana: { name: 'Chu·ªëi', seedName: 'bananaSeed', icon: 'üçå', timeToGrowing: 125000, timeToReady: 260000, harvestYield: 5, seedPrice: 13, cropPrice: 3, unlockTier: 5 },
  sweetpotato: { name: 'Khoai Lang', seedName: 'sweetpotatoSeed', icon: 'üç†', timeToGrowing: 130000, timeToReady: 280000, harvestYield: 3, seedPrice: 9, cropPrice: 4, unlockTier: 5 },
  ginger: { name: 'G·ª´ng', seedName: 'gingerSeed', icon: 'üåæ', timeToGrowing: 120000, timeToReady: 250000, harvestYield: 3, seedPrice: 13, cropPrice: 5, unlockTier: 5 },
  soybean: { name: 'ƒê·∫≠u N√†nh', seedName: 'soybeanSeed', icon: 'üå±', timeToGrowing: 140000, timeToReady: 300000, harvestYield: 8, seedPrice: 10, cropPrice: 2, unlockTier: 5 },

  grapes: { name: 'Nho', seedName: 'grapesSeed', icon: 'üçá', timeToGrowing: 150000, timeToReady: 300000, harvestYield: 10, seedPrice: 18, cropPrice: 2, unlockTier: 6 },
  greenapple: { name: 'T√°o Xanh', seedName: 'greenappleSeed', icon: 'üçè', timeToGrowing: 145000, timeToReady: 300000, harvestYield: 2, seedPrice: 15, cropPrice: 8, unlockTier: 6 },
  peanut: { name: 'ƒê·∫≠u Ph·ªông', seedName: 'peanutSeed', icon: 'ü•ú', timeToGrowing: 145000, timeToReady: 300000, harvestYield: 10, seedPrice: 12, cropPrice: 1, unlockTier: 6 },
  chilipepper: { name: '·ªöt Cay', seedName: 'chilipepperSeed', icon: 'üå∂Ô∏è', timeToGrowing: 100000, timeToReady: 210000, harvestYield: 8, seedPrice: 11, cropPrice: 2, unlockTier: 6 },
  papaya: { name: 'ƒêu ƒê·ªß', seedName: 'papayaSeed', icon: 'ü•≠', timeToGrowing: 175000, timeToReady: 360000, harvestYield: 2, seedPrice: 19, cropPrice: 11, unlockTier: 6 },
  leek: { name: 'T·ªèi T√¢y (Boa-r√¥)', seedName: 'leekSeed', icon: 'üßÖ', timeToGrowing: 85000, timeToReady: 180000, harvestYield: 2, seedPrice: 7, cropPrice: 4, unlockTier: 6 },

  peach: { name: 'ƒê√†o', seedName: 'peachSeed', icon: 'üçë', timeToGrowing: 160000, timeToReady: 320000, harvestYield: 2, seedPrice: 17, cropPrice: 10, unlockTier: 7 },
  pear: { name: 'L√™', seedName: 'pearSeed', icon: 'üçê', timeToGrowing: 155000, timeToReady: 310000, harvestYield: 2, seedPrice: 16, cropPrice: 9, unlockTier: 7 },
  mushroom: { name: 'N·∫•m', seedName: 'mushroomSeed', icon: 'üçÑ', timeToGrowing: 55000, timeToReady: 120000, harvestYield: 6, seedPrice: 15, cropPrice: 3, unlockTier: 7 },
  sugarcane: { name: 'M√≠a', seedName: 'sugarcaneSeed', icon: 'üéã', timeToGrowing: 190000, timeToReady: 380000, harvestYield: 3, seedPrice: 14, cropPrice: 6, unlockTier: 7 },
  plum: { name: 'M·∫≠n', seedName: 'plumSeed', icon: 'üçë', timeToGrowing: 165000, timeToReady: 330000, harvestYield: 4, seedPrice: 18, cropPrice: 5, unlockTier: 7 },
  asparagus: { name: 'MƒÉng T√¢y', seedName: 'asparagusSeed', icon: 'üåø', timeToGrowing: 100000, timeToReady: 220000, harvestYield: 4, seedPrice: 15, cropPrice: 4, unlockTier: 7 },
  
  cherry: { name: 'Anh ƒê√†o', seedName: 'cherrySeed', icon: 'üçí', timeToGrowing: 110000, timeToReady: 250000, harvestYield: 8, seedPrice: 22, cropPrice: 3, unlockTier: 8 },
  orange: { name: 'Cam', seedName: 'orangeSeed', icon: 'üçä', timeToGrowing: 170000, timeToReady: 350000, harvestYield: 3, seedPrice: 16, cropPrice: 7, unlockTier: 8 },
  rice: { name: 'L√∫a G·∫°o', seedName: 'riceSeed', icon: 'üåæ', timeToGrowing: 200000, timeToReady: 420000, harvestYield: 15, seedPrice: 10, cropPrice: 1, unlockTier: 8 },
  pumpkin: { name: 'B√≠ Ng√¥', seedName: 'pumpkinSeed', icon: 'üéÉ', timeToGrowing: 220000, timeToReady: 470000, harvestYield: 1, seedPrice: 20, cropPrice: 25, unlockTier: 8 },
  artichoke: { name: 'Atiso', seedName: 'artichokeSeed', icon: 'üå∏', timeToGrowing: 190000, timeToReady: 390000, harvestYield: 1, seedPrice: 22, cropPrice: 25, unlockTier: 8 },
  lentil: { name: 'ƒê·∫≠u LƒÉng', seedName: 'lentilSeed', icon: 'üü§', timeToGrowing: 130000, timeToReady: 280000, harvestYield: 12, seedPrice: 11, cropPrice: 1, unlockTier: 8 },
  
  watermelon: { name: 'D∆∞a H·∫•u', seedName: 'watermelonSeed', icon: 'üçâ', timeToGrowing: 200000, timeToReady: 450000, harvestYield: 1, seedPrice: 25, cropPrice: 30, unlockTier: 9 },
  avocado: { name: 'B∆°', seedName: 'avocadoSeed', icon: 'ü•ë', timeToGrowing: 220000, timeToReady: 480000, harvestYield: 2, seedPrice: 28, cropPrice: 18, unlockTier: 9 },
  olive: { name: '√î Liu', seedName: 'oliveSeed', icon: 'ü´í', timeToGrowing: 240000, timeToReady: 490000, harvestYield: 6, seedPrice: 26, cropPrice: 5, unlockTier: 9 },
  chestnut: { name: 'H·∫°t D·∫ª', seedName: 'chestnutSeed', icon: 'üå∞', timeToGrowing: 280000, timeToReady: 550000, harvestYield: 2, seedPrice: 35, cropPrice: 20, unlockTier: 9 },

  pineapple: { name: 'D·ª©a (Th∆°m)', seedName: 'pineappleSeed', icon: 'üçç', timeToGrowing: 250000, timeToReady: 500000, harvestYield: 1, seedPrice: 30, cropPrice: 35, unlockTier: 10 },
  coconut: { name: 'D·ª´a', seedName: 'coconutSeed', icon: 'ü••', timeToGrowing: 300000, timeToReady: 600000, harvestYield: 1, seedPrice: 40, cropPrice: 45, unlockTier: 10 },
  // Add more items here, ensuring they also have `unlockTier`
  durian: { name: 'S·∫ßu Ri√™ng', seedName: 'durianSeed', icon: 'ü§¢', timeToGrowing: 400000, timeToReady: 800000, harvestYield: 1, seedPrice: 100, cropPrice: 150, unlockTier: 10 },
  starfruit: { name: 'Kh·∫ø', seedName: 'starfruitSeed', icon: 'üåü', timeToGrowing: 180000, timeToReady: 350000, harvestYield: 5, seedPrice: 20, cropPrice: 5, unlockTier: 7 },
  lychee: { name: 'V·∫£i Thi·ªÅu', seedName: 'lycheeSeed', icon: 'üî¥', timeToGrowing: 220000, timeToReady: 450000, harvestYield: 10, seedPrice: 25, cropPrice: 3, unlockTier: 8 },
  dragonfruit: { name: 'Thanh Long', seedName: 'dragonfruitSeed', icon: 'ü©∑', timeToGrowing: 200000, timeToReady: 400000, harvestYield: 2, seedPrice: 30, cropPrice: 18, unlockTier: 9 },

};


export const ALL_CROP_IDS = Object.keys(CROP_DATA) as CropId[];
export const ALL_SEED_IDS = ALL_CROP_IDS.map(cropId => CROP_DATA[cropId].seedName as SeedId);


export const INITIAL_PLOTS: Plot[] = Array.from({ length: TOTAL_PLOTS }, (_, i) => ({
  id: i,
  state: 'empty',
}));

export const INITIAL_INVENTORY: GameState['inventory'] = {
  tomatoSeed: 5, carrotSeed: 3, cornSeed: 2, strawberrySeed: 2, potatoSeed: 1, lettuceSeed: 1,
  tomato: 0, carrot: 0, corn: 0, strawberry: 0, potato: 0, lettuce: 0,
};

// Initialize all other defined seeds and crops to 0 in inventory
ALL_SEED_IDS.forEach(seedId => {
  if (!INITIAL_INVENTORY[seedId]) {
    INITIAL_INVENTORY[seedId] = 0;
  }
});
ALL_CROP_IDS.forEach(cropId => {
  if (!INITIAL_INVENTORY[cropId]) {
    INITIAL_INVENTORY[cropId] = 0;
  }
});


export const INITIAL_GAME_STATE: GameState = {
  gold: INITIAL_GOLD,
  xp: INITIAL_XP,
  level: INITIAL_LEVEL,
  plots: INITIAL_PLOTS,
  inventory: INITIAL_INVENTORY,
  lastUpdate: Date.now(),
};

export const LEVEL_UP_XP_THRESHOLD = (level: number): number => {
  return Math.floor(100 * Math.pow(level, 1.5));
};

// MARKET_ITEMS will now be derived dynamically in useGameLogic based on CROP_DATA from Firestore
// This constant can be removed or kept for reference/fallback if needed.
// For now, I'll comment it out to emphasize the shift to dynamic market items.
/*
export const MARKET_ITEMS: MarketItem[] = [
  ...ALL_CROP_IDS.map(cropId => ({
    id: CROP_DATA[cropId].seedName as SeedId,
    name: `${CROP_DATA[cropId].name} (H·∫°t Gi·ªëng)`,
    price: CROP_DATA[cropId].seedPrice,
    type: 'seed' as 'seed',
    unlockTier: CROP_DATA[cropId].unlockTier, // Add unlockTier here
  })),
  ...ALL_CROP_IDS.map(cropId => ({
    id: cropId,
    name: CROP_DATA[cropId].name,
    price: CROP_DATA[cropId].cropPrice,
    type: 'crop' as 'crop',
    unlockTier: CROP_DATA[cropId].unlockTier, // Add unlockTier here, though usually crops are always sellable
  })),
];
*/

export const LOCAL_STORAGE_GAME_KEY = 'happyFarmGame';
